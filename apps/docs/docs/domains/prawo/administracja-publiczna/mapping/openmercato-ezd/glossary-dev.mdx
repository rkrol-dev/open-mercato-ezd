---
title: Słownik (dev)
sidebar_position: 30
---

Słownik pojęć implementacyjnych dla mapowania EZD → OpenMercato.

## Podstawowe pojęcia

### Encja

Rekord przechowywany w DB. Ma stabilne `id` i jest obsługiwany przez CRUD.

### Obiekt domenowy

Pojęcie z obszaru kancelaryjno‑archiwalnego (często 1:1 z encją, ale nie zawsze).

### Widok

Ujęcie raportowe / numeracja / lista operująca na danych encji.

Przykład: **RPW** jako numeracja/lista dla przesyłek wpływających.

### Proces

Akcja wieloetapowa, często wymagająca walidacji, uprawnień i konsekwencji pobocznych.
W MVP (CRUD) procesy dokumentujemy, ale nie implementujemy.



## Pojęcia związane z wielokancelaryjnością

### Kancelaria (Office)

Jednostka organizacyjna odpowiedzialna za obsługę przesyłek wpływających i wychodzących w ramach organizacji.

W modelu OpenMercato kancelaria jest reprezentowana jako **komórka organizacyjna** w `directory.organizations` (bez osobnej encji `records.offices`).

**Kluczowe cechy:**

- Organizacja może mieć wiele Kancelarii
- Numeracja RPW/RKW jest liczona w scope organizacji (sekwencja roczna); numer zawiera identyfikator komórki organizacyjnej
- Kancelaria określa zakres uprawnień pracowników (RBAC)
- Format numerów rejestrów jest narzucony (np. RPW: `RPW/{kanc_id}/{seq:5}/{yyyy}`)

**Przypadki użycia:**

- Organizacje z wieloma lokalizacjami (oddziały, delegatury)
- Podział organizacyjny według kompetencji (np. różne departamenty)
- Separacja danych dla różnych jednostek w ramach jednej organizacji

### Numeracja RPW i RKW per Kancelaria

Numer zawiera identyfikator kancelarii (komórki organizacyjnej), ale mechanizm sekwencji jest implementowany jako roczny scope numeracji.

**Zakres numeracji:**

- Organizacja + Tenant + rok
- Komórka organizacyjna wpływa na segment `kanc_id` w numerze

**Przykład:**

- Kancelaria A: RPW-A/2026/000001, RPW-A/2026/000002, ... oraz RKW-A/2026/000001, RKW-A/2026/000002, ...
- Kancelaria B: RPW-B/2026/000001, RPW-B/2026/000002, ... oraz RKW-B/2026/000001, RKW-B/2026/000002, ...

### Uprawnienia w kontekście Kancelarii

Pracownik może być przypisany do jednej lub wielu Kancelarii.

**Zasady RBAC:**

- Użytkownik widzi tylko zasoby z Kancelarii, do których jest przypisany
- Role w Kancelarii: Administrator, Pracownik, Czytelnik
- Dodatkowe filtry: poziom dostępu dokumentu, status sprawy

## Pojęcia kancelaryjno‑archiwalne

### Przesyłka wpływająca

Jednostka rejestracji wpływu. Nie ma „statusów”, ale ma **oznaczenia** dotyczące odwzorowania:

- zarejestrowana w składzie chronologicznym,
- odwzorowana w pełni,
- odwzorowana częściowo.

### RPW

Rejestr Przesyłek Wpływających jako **widok/numeracja** – nie osobna encja.

### Przesyłka wychodząca

Jednostka rejestracji wysyłki. Reprezentuje przesyłkę wysyłaną (wydawaną) przez organizację.

- Zwana również "Wysyłka"
- Numerowana w RKW (Rejestr Przesyłek Wychodzących)
- Zawiera dokumenty wychodzące
- Obsługiwana przez konkretną Kancelarię

### RKW

**RKW = Rejestr Przesyłek Wychodzących** (terminologia projektowa dla spójności ze źródłami).

Rejestr Przesyłek Wychodzących jako **widok/numeracja** – nie osobna encja. Analogiczny do RPW, ale dla przesyłek wychodzących.

### Sprawa

Podstawowa jednostka katalogowania dokumentacji i czynności. Sprawa jest tą samą encją co wcześniejsza "Koszulka".

**Sprawa = Koszulka z przypisanym znakiem sprawy.**

- Rekord sprawy może mieć przypisany znak sprawy (wtedy funkcjonuje jako pełna sprawa) lub może pozostać bez znaku (wtedy funkcjonuje jako kontener roboczy/teczka tematyczna).
- Sprawa może być powiązana z inną sprawą (niezależnie od tego, czy mają przypisany znak sprawy).
- Sprawa może zostać zamknięta (read-only).

### Powiązanie (neutralne)

Neutralny (bez etykiety) i symetryczny link między dwoma sprawami (rekordami).

- Dopuszczamy powiązania między dowolnymi rekordami sprawy (niezależnie od tego, czy mają przypisany znak sprawy).
- Powiązania są blokowane, jeśli dowolna strona jest read-only.

### Spis spraw

Rejestr spraw, w ramach którego numerowane są sprawy (szczegóły numeracji do dopięcia).

### Dokument

Nośnik treści. Może:

- istnieć niezależnie (np. „przyniesiony” bez przesyłki),
- być przypięty do przesyłki wpływającej (`incomingShipmentId`),
- być przypięty do sprawy **albo** koszulki.

- mieć jednocześnie przesyłkę wpływającą i wychodzącą (dokument wpływający i odpowiedź wychodząca to jeden rekord z dwoma numerami przesyłek).
Zasada: dokument może być przypięty do **dokładnie jednego** obiektu (sprawy albo koszulki) lub do żadnego.

Jeśli sprawa jest read-only, nie można dopinać/odpiąć dokumentów.

#### Dokument jako załącznik z metadanymi

W implementacji, dokument jest konceptualnie **załącznikiem z metadanymi**:

- **Encja `records.documents`** przechowuje metadane (tytuł, rodzaj, poziom dostępu, daty, powiązania).
- **Moduł `attachments` (core)** zarządza fizycznymi plikami.
- Relacja: dokument ma pole `attachmentIds` z referencjami do plików.

**Główny właściciel załączników** (primary owner) jest określany przez kontekst dokumentu:

- Dokument powiązany z przesyłką wpływającą (`incomingShipmentId`) lub wychodzącą (`outgoingShipmentId`) → właściciel: przesyłka
- Dokument powiązany ze sprawą (`caseId`) → właściciel: sprawa (niezależnie od tego, czy ma przypisany znak sprawy)
- Dokument samodzielny → właściciel: dokument

**RBAC dla załączników**: Dostęp kontrolowany przez uprawnienia do głównego właściciela + poziom dostępu dokumentu + status właściciela.

### Załącznik (attachment)

Fizyczny plik zarządzany przez moduł `attachments` (core). Załączniki mogą być powiązane z różnymi encjami w systemie, w tym z dokumentami w module `records`.

W kontekście modułu `records`:

- Załączniki są plikami dokumentów (PDF, DOCX, JPG itp.).
- Dokument może mieć jeden lub więcej załączników.
- Metadane załącznika (nazwa pliku, rozmiar, typ MIME) są zarządzane przez moduł `attachments`.

### Skład chronologiczny – lokalizacja

Encja opisująca lokalizację przechowywania i jej historię zmian.


### Strony (Case Parties)

Podmioty zaangażowane w sprawę – osoby fizyczne, prawne lub jednostki organizacyjne.

**Kluczowe cechy:**

- Każda strona jest powiązana z konkretną sprawą (niezależnie od tego, czy ma przypisany znak sprawy)
- Strona ma określoną rolę (wnioskodawca, uczestnik, obserwator, strona postępowania)
- Strona może być podmiotem zarejestrowanym (referencja do `customers`) lub ad-hoc (tylko nazwa)

**Zasady:**

- Jedna sprawa może mieć wiele stron
- Strona może występować w różnych rolach w tej samej sprawie
- Jeśli sprawa jest read-only, strony nie mogą być modyfikowane
- Historia stron jest zachowana (audit log)

**Typy stron (MVP):**

- **Wnioskodawca** (applicant) – podmiot inicjujący sprawę
- **Uczestnik** (participant) – podmiot uczestniczący w sprawie
- **Obserwator** (observer) – podmiot informowany o przebiegu
- **Strona postępowania** (party_to_proceedings) – strona w postępowaniu administracyjnym
